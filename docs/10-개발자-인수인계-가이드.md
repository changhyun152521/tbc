# TBC CLASS — 개발자 인수인계 가이드

다른 개발자가 프로젝트를 이어받아 작업하거나, AI(프롬프트)로 기능을 추가·수정할 때 **복사·붙여넣기**해서 쓸 수 있도록 정리한 문서입니다.  
화면 디자인 → 백엔드 → 프론트엔드 순으로 구성했습니다.

---

## 목차

1. [프로젝트 개요 및 기술 스택](#1-프로젝트-개요-및-기술-스택)
2. [화면·디자인 시스템](#2-화면디자인-시스템)
3. [백엔드 구조 및 API](#3-백엔드-구조-및-api)
4. [프론트엔드 구조](#4-프론트엔드-구조)
5. [프롬프트 작성 가이드](#5-프롬프트-작성-가이드)

---

## 1. 프로젝트 개요 및 기술 스택

### 1.1 프로젝트란?

- **TBC CLASS**: 학원 운영·수업·출결·과제 관리를 위한 웹 애플리케이션
- **관리자/강사**: 학생·강사·반·수업(교시·출결·과제) 관리
- **학생/학부모**: 대시보드, 수업 이력, 성적, 프로필 등

### 1.2 저장소 구조

```
TBC-CLASS/
├── backend/          # Express + TypeScript API
├── frontend/         # React + Vite + TypeScript
├── docs/             # 기획·설계·보고 문서
├── package.json      # 루트 (workspace 등)
```

### 1.3 기술 스택

| 구분 | 기술 |
|------|------|
| **백엔드** | Node.js, Express, TypeScript, Mongoose, MongoDB, JWT, bcrypt, express-validator |
| **프론트** | React 18, TypeScript, Vite, React Router v6, Axios, Tailwind CSS, Framer Motion |
| **DB** | MongoDB (로컬 기본: `mongodb://localhost:27017/tbc-class`) |

### 1.4 실행 방법

- **백엔드**: `cd backend && npm run dev` → `http://localhost:3001`
- **프론트**: `cd frontend && npm run dev` → `http://localhost:5173`
- 프론트는 Vite proxy로 `/api` 요청을 `http://localhost:3001`로 전달합니다.

---

## 2. 화면·디자인 시스템

### 2.1 폰트 (index.css)

- **본문·일반 UI**: `Pretendard` (Variable, `/fonts/PretendardVariable.ttf`)
- **제목·브랜드(영문/숫자)**: `Inter` Bold — `.font-title`
- **숫자·데이터 정렬**: `Inter` + tabular-nums — `.font-number`
- **강조/알림**: `ONEMobile` Bold — `.font-emphasis`
- **친근한 강조(학생/학부모)**: `NanumSquareRound` — `.font-friendly`

폰트 파일은 `frontend/public/fonts/`에 두고, `index.css`의 `@font-face`에서 `/fonts/...`로 참조합니다.

### 2.2 색상·테마 (Tailwind)

- **배경**: `bg-slate-50` (목록/메인), `bg-white` (카드·테이블)
- **본문 텍스트**: `text-slate-900`, `text-slate-700`, `text-slate-600`
- **보조/플레이스홀더**: `text-slate-500`, `text-slate-400`
- **강조 제목**: `text-slate-950` + `font-semibold` 또는 `font-bold`
- **테두리**: `border-slate-200`, `border-slate-100`
- **사이드바**: `bg-slate-800`, `text-slate-200`, 선택 시 `bg-blue-600 text-white`
- **주요 버튼(CTA)**: `bg-slate-950 text-white` / `hover:bg-slate-800`
- **보조 버튼**: `border border-slate-200` / `hover:bg-slate-50`
- **위험(삭제 등)**: `text-red-600`, `bg-red-600`, `border-red-200`
- **에러 메시지**: `bg-red-50 text-red-600`

### 2.3 레이아웃 규칙

- **관리자 레이아웃 (AdminLayout)**
  - 데스크탑: 좌측 고정 사이드바 `w-56 bg-slate-800`, 메인은 `lg:pl-56`
  - 상단 헤더: `h-14 bg-white border-b border-slate-200`, 제목 + 로그아웃
  - 모바일: 햄버거 메뉴 → Framer Motion 드로어
- **메인 콘텐츠**
  - 페이지 공통: `min-h-screen bg-slate-50`, 상단 `pt-6`, 좌우 `px-4 sm:px-6 lg:px-10`, 하단 `pb-12`
  - 최대 너비: `max-w-6xl mx-auto` (반·수업 상세 등 테이블 있는 페이지)
- **테이블**
  - 카드: `bg-white border border-slate-200 rounded-2xl overflow-hidden shadow-sm`
  - 테이블 래퍼: `overflow-x-auto scrollbar-table` (가로 스크롤 시 얇은 스크롤바)
  - thead: `bg-slate-50 border-b border-slate-200`, `text-slate-600 text-[13px] font-semibold`
  - th/td: `p-4` 또는 `py-3 px-4`, 헤더는 `text-slate-500 text-xs font-bold`도 사용
  - tbody: `divide-y divide-slate-100`, 행 hover: `hover:bg-slate-50`
- **모달**
  - 오버레이: `fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/50`
  - 박스: `bg-white border border-slate-200 rounded-2xl shadow-lg`, 클릭 전파 방지

### 2.4 버튼·입력 스타일

- **주요 버튼**: `px-4 py-2.5 bg-slate-950 text-white rounded-lg text-sm font-semibold hover:bg-slate-800`
- **보조 버튼**: `px-4 py-2.5 border border-slate-200 rounded-lg text-slate-700 font-medium hover:bg-slate-50`
- **작은 보조 버튼(일괄 O 등)**: `px-2 py-1 text-[11px] sm:text-xs font-medium border border-slate-200 rounded-lg text-slate-700 hover:bg-slate-100`
- **텍스트 입력**: `px-4 py-2.5 bg-white border border-slate-200 rounded-lg text-[14px] text-slate-900 placeholder:text-slate-400 focus:border-slate-900 focus:ring-1 focus:ring-slate-900 outline-none`
- **select**: 동일 border/radius, `text-slate-700`

### 2.5 유틸리티 클래스

- **스크롤바 (테이블)**: `.scrollbar-table` — 얇고 투명한 스크롤바 (index.css에 정의)
- **제목 폰트**: `.font-title` (Inter Bold)
- **숫자 정렬**: `.font-number` (tabular-nums)

### 2.6 반응형

- 모바일 우선, `sm:`, `lg:` 브레이크포인트 사용
- 테이블은 `min-w-[600px]` 등으로 최소 너비 지정 후 부모에 `overflow-x-auto` 적용해 가로 스크롤 유지

---

## 3. 백엔드 구조 및 API

### 3.1 디렉터리 구조

```
backend/src/
├── app.ts              # Express 앱, 라우트 마운트, errorHandler
├── server.ts           # MongoDB 연결, ensureAdmin, 서버 listen
├── config/index.ts     # serverConfig, dbConfig, jwtConfig
├── middlewares/        # auth.middleware, errorHandler
├── models/             # Mongoose 모델 (User, Class, Student, Teacher, LessonDay 등)
├── routes/             # auth, me, admin, teacher, student, parent
├── controllers/        # admin/*, auth, me, student, teacher, parent
├── services/           # admin/*, auth, me, student/*, teacher/*
└── types/api.ts        # ApiResponse, JwtPayload, Request.user
```

### 3.2 설정 (config/index.ts)

- **serverConfig.port**: `3001`
- **dbConfig.uri**: `mongodb://localhost:27017/tbc-class`
- **jwtConfig**: secret, expiresIn `24h`  
(현재 .env 미사용, 코드 내 상수 사용)

### 3.3 인증

- **로그인**: `POST /api/auth/login` → `{ loginId, password }` → `{ success, data: { token, user: { id, role, name } } }`
- **미들웨어**: `authenticate` (JWT 검증, `Authorization: Bearer <token>`), `requireRoles(['admin','teacher'])` 등
- **역할**: `admin` | `teacher` | `student` | `parent`

### 3.4 모델 요약

| 모델 | 파일 | 핵심 필드 |
|------|------|-----------|
| **User** | User.model.ts | loginId, passwordHash, role, name, phone |
| **Class** | Class.model.ts | name, teacherIds[], studentIds[], description |
| **Student** | Student.model.ts | name, school, grade, studentPhone, parentPhone, userId, parentUserId, classId? |
| **Teacher** | Teacher.model.ts | name, userId, description |
| **LessonDay** | LessonDay.model.ts | classId, date, periods[] (각 period: teacherId, memo?, records[] (studentId, attendance, homework, note?)) |

- **LessonDay**: `classId` + `date` 유니크 인덱스 (반·날짜당 1개 수업일)
- **attendance / homework**: `'O' | 'X' | ''`

### 3.5 Admin API 라우트 (prefix: `/api/admin`)

- **인증**: 모든 라우트 `authenticate` + `requireRoles(['admin','teacher'])`

| 메서드 | 경로 | 설명 |
|--------|------|------|
| POST | /students | 학생 생성 (name, school, grade, studentPhone, parentPhone 등) |
| GET | /students | 목록 (query: name, grade, classId, search, page, limit) |
| GET | /students/:id | 단건 |
| PUT | /students/:id | 수정 |
| DELETE | /students/:id | 삭제 |
| POST | /teachers | 강사 생성 |
| GET | /teachers | 목록 |
| GET | /teachers/:id | 단건 |
| PUT | /teachers/:id | 수정 |
| DELETE | /teachers/:id | 삭제 |
| POST | /classes | 반 생성 |
| GET | /classes | 목록 |
| GET | /classes/for-lessons | 수업관리용 반 목록 (todayPeriodCount 포함) |
| GET | /classes/:id | 단건 (teacherIds, studentIds populate) |
| PUT | /classes/:id | 수정 |
| DELETE | /classes/:id | 삭제 |
| POST | /classes/:id/teachers | body: teacherId |
| DELETE | /classes/:id/teachers | query/body: teacherId |
| POST | /classes/:id/students | body: studentIds[] |
| DELETE | /classes/:id/students | query/body: studentId |
| POST | /lesson-days | body: classId, date |
| GET | /lesson-days | query: dateFrom, dateTo, classId, teacherId |
| GET | /lesson-days/by-class-date | query: classId, date (해당 날짜 수업일 1건 또는 null) |
| GET | /lesson-days/:id | 단건 (populate) |
| PUT | /lesson-days/:id | body: date?, classId? |
| DELETE | /lesson-days/:id | 삭제 |
| POST | /lesson-days/:id/periods | body: teacherId |
| DELETE | /lesson-days/:id/periods | query: periodIndex |
| PUT | /lesson-days/:id/periods | body: periodIndex, teacherId?, memo?, records? |

- **공통 응답**: `{ success: boolean, data?: T, message?: string }`

### 3.6 기타 API

- **auth**: `POST /api/auth/login`
- **me**: 인증 후 내 정보 등 (필요 시 확인)
- **teacher / student / parent**: 역할별 API (필요 시 routes 파일 참고)

---

## 4. 프론트엔드 구조

### 4.1 디렉터리 구조

```
frontend/src/
├── api/client.ts        # axios 인스턴스, baseURL /api, Bearer 토큰 주입
├── config.ts            # apiBaseUrl (Vite env 또는 '')
├── App.tsx, main.tsx
├── router.tsx           # createBrowserRouter, AuthGuard, 레이아웃
├── index.css            # Tailwind, 폰트, scrollbar-table
├── contexts/AuthContext.tsx   # login, logout, token, role, name, isReady
├── components/
│   ├── AuthGuard.tsx    # 역할별 접근, 비로그인 시 /login
│   ├── ScrollToTop.tsx
│   ├── ui/              # Pagination, StatCard 등
│   ├── student/         # StudentSearchFilter, StudentTable, StudentFormModal, ExcelDropdown 등
│   ├── teacher/         # TeacherFormModal, TeacherTable 등
│   ├── class/           # ClassTable, AddStudentsModal, AddTeachersModal 등
│   └── lesson/          # DateNavigator, PeriodSection, AttendanceHomeworkTable 등
├── layouts/
│   ├── AdminLayout.tsx  # 사이드바, 헤더, Outlet
│   └── StudentLayout.tsx
├── pages/               # 각 화면 컴포넌트
└── types/               # auth, student, teacher, class, lesson
```

### 4.2 라우팅 (router.tsx)

- `/login` → Login
- `/admin` → AuthGuard(admin|teacher) + AdminLayout  
  - dashboard, students, teachers, classes, classes/:id, lessons, **lessons/classroom/:classId**, lessons/:id
- `/student` → AuthGuard(student|parent) + StudentLayout  
  - dashboard, lessons, tests, profile
- `/` → /login 리다이렉트  
- `*` → /login 리다이렉트

**주의**: `lessons/classroom/:classId`는 `lessons/:id`보다 먼저 정의되어야 합니다.

### 4.3 API 클라이언트

- **apiClient**: axios 인스턴스, `baseURL: ${apiBaseUrl}/api`
- **토큰**: `localStorage` 또는 `sessionStorage`의 `tbc_token`을 읽어 `Authorization: Bearer`로 설정
- 개발 시 `apiBaseUrl` 비우면 상대 경로 `/api` → Vite proxy로 3001 전달

### 4.4 인증 (AuthContext)

- **저장**: token, role, name (tbc_token, tbc_role, tbc_name), remember 여부에 따라 localStorage/sessionStorage
- **login(loginId, password, remember)** → API 호출 후 저장
- **logout()** → 저장소 비우기
- **useAuth()**: token, role, name, isAuthenticated, isReady, login, logout

### 4.5 타입 (types/)

- **auth**: UserRole, User, LoginResponse, AuthState
- **student**: StudentListItem, StudentFormValues, GRADE_OPTIONS
- **teacher**: TeacherListItem, TeacherFormValues, TeacherExcelRow
- **class**: TeacherRef, ClassListItem, ClassListItemForLesson, ClassDetail, ClassStudentItem, ClassFormValues
- **lesson**: AttendanceHomeworkValue, LessonDayListItem, StudentRecord, PeriodItem, LessonDayDetail, LessonDayFormValues

### 4.6 주요 페이지 역할

| 경로 | 페이지 | 역할 |
|------|--------|------|
| /admin/students | StudentManagement | 학생 목록, 검색/필터, 추가·수정·삭제, 엑셀 |
| /admin/teachers | TeacherManagement | 강사 목록, CRUD, 엑셀 |
| /admin/classes | ClassManagement | 반 목록, CRUD |
| /admin/classes/:id | ClassDetail | 반 상세, 강사/학생 추가·제거 |
| /admin/lessons | LessonManagement | **반 목록** (수업관리 진입), 교실관리 버튼 |
| /admin/lessons/classroom/:classId | ClassroomPage | **교실관리**: 날짜 선택, 교시 추가, 출결/과제/비고, 엑셀 내보내기 |
| /admin/lessons/:id | LessonDetail | 수업일 단건 상세 (기존 호환) |

### 4.7 수업관리 흐름 (반 중심)

1. 수업 관리 메뉴 → **반 목록** (반 이름, 담당 강사, 소속 학생 수, 오늘 등록 교시 수, [교실관리])
2. [교실관리] 클릭 → `/admin/lessons/classroom/:classId` (**ClassroomPage**)
3. 교실관리: 상단에 반 이름, 담당 강사, 총 학생 수, **날짜 선택**, [교시 추가], [엑셀 내보내기]
4. 해당 반·날짜의 수업일이 없으면 “교시 추가” 시 수업일 생성 후 교시 추가
5. 교시별: 담당 강사, 수업 내용(메모), 테이블(이름 | 출석 | 과제 | 비고), 저장/삭제
6. **학생 목록**: 해당 반 소속 전체, **이름 가나다순** 고정

---

## 5. 프롬프트 작성 가이드

다른 개발자가 AI에게 지시할 때 아래 형식을 복사해 채워 쓰면 됩니다.

### 5.1 디자인 일관성 유지

```
이 프로젝트는 TBC CLASS 학원 관리 웹앱입니다.
- 디자인: Tailwind, 슬레이트 계열(slate-50/200/700/950), 카드/테이블은 흰 배경, rounded-2xl, border-slate-200.
- 폰트: 본문 Pretendard, 제목/브랜드 .font-title (Inter Bold).
- 관리자 페이지는 AdminLayout 안에 있고, 메인 콘텐츠는 min-h-screen bg-slate-50, max-w-6xl mx-auto, pt-6 px-4 sm:px-6 lg:px-10 pb-12 를 유지해줘.
- 테이블은 overflow-x-auto scrollbar-table, thead bg-slate-50, 버튼은 기존 학생/반 관리 페이지와 동일한 스타일로 맞춰줘.
```

### 5.2 백엔드 추가

```
백엔드: Express + Mongoose (TypeScript) 사용 중.
- 새 API는 backend/src/routes/admin.routes.ts 에 라우트 추가하고, controller/service 패턴으로 구현해줘.
- 인증은 authenticate + requireRoles(['admin','teacher']) 적용돼 있어. 응답 형식은 { success, data?, message? }.
- 모델은 backend/src/models/ 에 있고, LessonDay 같은 기존 모델 스키마를 참고해서 필드 타입을 맞춰줘.
```

### 5.3 프론트엔드 추가

```
프론트: React 18 + TypeScript + Vite + React Router v6.
- API 호출은 frontend/src/api/client.ts 의 apiClient 사용 (Bearer 토큰 자동).
- 타입은 frontend/src/types/ 에 student, class, lesson, teacher, auth 등으로 나뉘어 있어. 새 도메인이면 새 파일 추가해줘.
- 관리자 페이지는 router.tsx 에서 /admin 하위에 자식 라우트로 등록하고, AdminLayout 사용 중.
- 새 목록/폼 페이지는 기존 StudentManagement, ClassDetail 같은 페이지의 테이블·모달·검색 패턴을 따라줘.
```

### 5.4 수업/교실 관련

```
수업관리는 "반 중심" 구조야.
- 수업 관리 메뉴 첫 화면은 반 목록 (LessonManagement). 여기서 [교실관리]로 들어가면 ClassroomPage (경로: lessons/classroom/:classId).
- 교실관리 페이지에서는 날짜 선택 후 해당 반·날짜의 수업일(LessonDay)을 조회/생성하고, 교시별로 출결·과제·비고를 관리해.
- 반 소속 학생은 항상 가나다순으로 표시하고, PeriodSection/AttendanceHomeworkTable 컴포넌트를 사용해.
- 백엔드: GET /api/admin/lesson-days/by-class-date?classId=&date=, POST /api/admin/lesson-days, POST /api/admin/lesson-days/:id/periods 등 사용 중.
```

### 5.5 전체 컨텍스트 한 번에 넘기기

```
TBC CLASS 프로젝트 인수인계 문서를 기반으로 작업해줘.
- docs/10-개발자-인수인계-가이드.md 에 화면 디자인(폰트, 색상, 레이아웃, 버튼/테이블/모달), 백엔드(모델, Admin API 라우트, 인증), 프론트(라우팅, api client, AuthContext, 타입, 페이지 역할)가 정리돼 있어.
- 변경할 파일과 추가할 기능만 구체적으로 적을게. 위 가이드의 컨벤션과 구조를 유지하면서 구현해줘.
```

---

이 문서를 복사·붙여넣기하거나, 필요한 섹션만 추려서 프롬프트에 포함하면 다른 개발자나 AI가 이어서 개발하기 쉬워집니다.  
추가·수정이 생기면 이 문서를 함께 갱신하는 것을 권장합니다.
